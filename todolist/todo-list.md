

> 目标：在保留现有 3D 时间线的基础上，为用户提供多种具备纵深感、沉浸式体验的探索模式。以下任务按模式拆分，便于分阶段实施。


## 0. 基础设施

- [x] 抽象现有 `Timeline3D` 组件核心逻辑（数据加载、焦点管理、滚轮事件）为可复用服务层。

- [x] 定义 "模式" 接口（包含曲线生成、节点布局、相机控制、HUD 配置）。
  - 创建 `ITimelineMode.ts` - 19个必实现方法 + 7个支持类型
  - 创建 `BaseTimelineMode.ts` - 抽象基类模板方法实现
  - 创建 `INTERFACE_VERIFICATION.ts` - 设计验证文档
  - 创建 `COMPLETION_REPORT.ts` - 完成报告
  - 创建 `QUICK_START.md` - 快速参考指南

- [x] 为模式切换添加顶栏 Tabs 与懒加载机制，确保模式切换时释放旧场景资源。
  - 创建 `ModeSwitcher.tsx` 和 `ModeInfoCard` 组件
  - 创建 `ModeFactory.ts` 工厂模式实现
  - 重构 `Timeline3D.tsx` 为模式容器，支持动态模式加载
  - 实现取消标记（cancellation token）机制防止竞态条件

- [x] 建立统一的动画控制，支持滚轮推进、平滑过渡、提示标签同步动画。
  - 在 `BaseTimelineMode` 中实现统一的焦点管理和回调机制
  - 支持平滑的相机过渡和节点状态动画

## 1. 河流巡航（River Cruise）✅

- [x] 生成沿主样条（Catmull-Rom）起伏的河道 Mesh，并添加水流纹理动画。
  - 实现程序化河道几何体生成（200段，宽度4.5单位）
  - 创建高分辨率法线贴图（256x256）模拟水波
  - 添加实时顶点动画（三层波浪叠加）
  - 实现法线贴图流动动画和材质属性动态变化

- [x] 设置相机跟随和滚轮推进，焦点模型位于观察者视野中。
  - 逐个节点滚轮滚动（非停靠点跳跃）
  - 相机平滑跟随当前聚焦节点
  - 节点位于河道右侧，相机从上方俯瞰

- [x] 设计专属 HUD：包含停靠点信息、模式说明。
  - 实现 `ModeInfoCard` 显示模式特性和操作说明
  - 支持自定义 HUD 元素（停靠点指示器）

- [x] 调整远景雾化/色彩渐变，突出远近层次。
  - 浅蓝色天空背景（0xe0f2fe）
  - 雾化效果（近距15，远距60）
  - 高金属度（0.8）和低粗糙度（0.1）的水面材质

  

## 2. 峡谷漫游（Canyon Walk）

- [ ] 构建峡谷墙体（左右半透明 Mesh），用于展示厂商或模型类别标签。

- [ ] 沿峡谷底部铺设“栈道”，节点从侧壁探出，焦点节点时相机带侧倾效果。

- [ ] 提供模式专属控制：例如墙体信息开关、漫游速度调节。

- [ ] 加入地貌高度线/灯光投射，增强纵深感。

  

## 3. 星轨螺旋（Helix Constellation）

- [ ] 将节点布局到向上螺旋的路径（使用极坐标 → 笛卡尔转换），年份映射到高度。

- [ ] 为节点添加粒子尾迹或发光轨迹，当前节点突出显示。

- [ ] 设计小型极坐标“概览图”，提示所在圈层与年份区间。

- [ ] 处理滚轮 → 螺旋推进的相机动画与缓动，确保用户不会迷失方向。

  

## 4. 砂箱探索（Sandbox Explorer）

- [ ] 在现有模式基础上开放 WASD + 鼠标自由漫游；滚轮改为前后加速。

- [ ] 添加指南针/锚点列表，允许用户快速跳转至关键年份或厂商。

- [ ] 提供热力图叠层（例如节点密度、热门厂商），供高级用户开关。

- [ ] 优化性能（LOD、批处理）以支持自由场景浏览。

  

## 5. 统一交互与测试

- [ ] 统一滚轮推进与提示文案（Next/Prev 标签等）在所有模式的表现。

- [ ] 为每个模式撰写使用说明及截图/GIF，更新文档与 README。

- [ ] 编写模式切换与滚轮交互的端到端测试（Playwright 或 Cypress）。

- [ ] 收集用户反馈（可通过 feature flag 或问卷），决定最终上线的默认模式。