

> 目标：在保留现有 3D 时间线的基础上，为用户提供多种具备纵深感、沉浸式体验的探索模式。以下任务按模式拆分，便于分阶段实施。


## 0. 基础设施

- [x] 抽象现有 `Timeline3D` 组件核心逻辑（数据加载、焦点管理、滚轮事件）为可复用服务层。

- [x] 定义 "模式" 接口（包含曲线生成、节点布局、相机控制、HUD 配置）。
  - 创建 `ITimelineMode.ts` - 19个必实现方法 + 7个支持类型
  - 创建 `BaseTimelineMode.ts` - 抽象基类模板方法实现
  - 创建 `INTERFACE_VERIFICATION.ts` - 设计验证文档
  - 创建 `COMPLETION_REPORT.ts` - 完成报告
  - 创建 `QUICK_START.md` - 快速参考指南

- [x] 为模式切换添加顶栏 Tabs 与懒加载机制，确保模式切换时释放旧场景资源。
  - 创建 `ModeSwitcher.tsx` 和 `ModeInfoCard` 组件
  - 创建 `ModeFactory.ts` 工厂模式实现
  - 重构 `Timeline3D.tsx` 为模式容器，支持动态模式加载
  - 实现取消标记（cancellation token）机制防止竞态条件

- [x] 建立统一的动画控制，支持滚轮推进、平滑过渡、提示标签同步动画。
  - 在 `BaseTimelineMode` 中实现统一的焦点管理和回调机制
  - 支持平滑的相机过渡和节点状态动画

## 1. 河流巡航（River Cruise）✅

- [x] 生成沿主样条（Catmull-Rom）起伏的河道 Mesh，并添加水流纹理动画。
  - 实现程序化河道几何体生成（200段，宽度4.5单位）
  - 创建高分辨率法线贴图（256x256）模拟水波
  - 添加实时顶点动画（三层波浪叠加）
  - 实现法线贴图流动动画和材质属性动态变化

- [x] 设置相机跟随和滚轮推进，焦点模型位于观察者视野中。
  - 逐个节点滚轮滚动（非停靠点跳跃）
  - 相机平滑跟随当前聚焦节点
  - 节点位于河道右侧，相机从上方俯瞰

- [x] 设计专属 HUD：包含停靠点信息、模式说明。
  - 实现 `ModeInfoCard` 显示模式特性和操作说明
  - 支持自定义 HUD 元素（停靠点指示器）

- [x] 调整远景雾化/色彩渐变，突出远近层次。
  - 浅蓝色天空背景（0xe0f2fe）
  - 雾化效果（近距15，远距60）
  - 高金属度（0.8）和低粗糙度（0.1）的水面材质

## 2. 星轨螺旋（Helix Constellation）✅

- [x] 将节点布局到向上螺旋的路径（使用极坐标 → 笛卡尔转换），年份映射到高度。
  - 实现极坐标到笛卡尔坐标转换（`timeToHelixPosition`）
  - 6 圈螺旋结构，总高度 24 单位
  - 螺旋半径 6.0 单位，每圈高度 4.0 单位
  - 1000 个粒子背景模拟星空效果

- [x] 为节点添加粒子尾迹或发光轨迹，当前节点突出显示。
  - 创建径向渐变发光精灵（金色到红色渐变）
  - 使用加法混合（AdditiveBlending）产生真实发光效果
  - 脉动动画（0.85-1.15 倍缩放）和旋转动画
  - 实现碰撞检测避免节点重合（最小距离 0.3 单位）

- [x] 设计小型极坐标"概览图"，提示所在圈层与年份区间。
  - 右下角圆形进度指示器（Canvas 实现）
  - 显示当前圈层（1-6）和精确进度
  - 可视化元素：背景圆环、分隔线、金色进度弧、发光圆点指示器
  - 半透明深色背景 + 毛玻璃效果

- [x] 处理滚轮 → 螺旋推进的相机动画与缓动，确保用户不会迷失方向。
  - 动态缓动系统：基于距离调整速度（远快近慢）
  - 相机水平环绕焦点，固定高度偏移 5 单位
  - 禁用 OrbitControls 确保相机完全由代码控制
  - 平滑的焦点切换和节点状态过渡动画
